Class User.Configuration Extends %RegisteredObject
{

ClassMethod UpdateSSLSuperServer() As %Boolean [ Language = objectscript ]
{
 set p("CertificateFile")="c:\Certificados\cert.pem"
 set p("Ciphersuites")="TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256"
 set p("Description")="Autogenerated SuperServer Configuration"
 set p("Enabled")=1
 set p("PrivateKeyFile")="c:\Certificados\key.pem"
 // set p("PrivateKeyPassword")=""
 set p("PrivateKeyType")=2
 set p("TLSMaxVersion")=32
 set p("TLSMinVersion")=16 // Set TLSMinVersion to 32 to stick with TLSv1.3
 set p("Type")=1
 set sc = ##class(Security.SSLConfigs).Create("%SuperServer", .p)
 kill p

 set p("SSLSuperServer")=1
 set sc = ##class(Security.System).Modify("SYSTEM", .p)
 kill p
 
 return 1
}

ClassMethod SetupTestTable(pNS As %String = "USER") As %Boolean [ Language = objectscript ]
{
	#dim oldNS as %String = $namespace

	set $namespace = pNS
	if '##class(%Dictionary.CompiledClass).%ExistsId("Phonebook.Company")
	{
		&SQL(CREATE TABLE Phonebook.Company (Code VARCHAR(50), Name VARCHAR(50), Address VARCHAR(50)))
	}
	set $namespace = oldNS
	return 1
}

}
